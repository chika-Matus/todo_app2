<!-- app/views/layouts/application.html.erb -->
<!DOCTYPE html>
<html>
  <head>
    <title>TODOアプリ</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    
    <!-- Rails UJS for method: :delete support -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/rails-ujs/5.2.8/rails-ujs.min.js"></script>
    <script>Rails.start();</script>
    
    <style>
      body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
      .container { max-width: 800px; margin: 0 auto; }
      .header { background: #333; color: white; padding: 15px; margin-bottom: 20px; }
      .nav { display: flex; justify-content: space-between; align-items: center; }
      .btn { padding: 8px 16px; background: #007bff; color: white; text-decoration: none; border-radius: 4px; border: none; cursor: pointer; font-size: 14px; margin-right: 8px; }
      .btn-danger { background: #dc3545; }
      .form-group { margin-bottom: 15px; }
      .form-control { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
      .todo-item { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 4px; }
      .completed { background-color: #f8f9fa; opacity: 0.7; }
      .flash { padding: 10px; margin-bottom: 20px; border-radius: 4px; }
      .notice { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
      .alert { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
  </head>

  <body>
    <div class="header">
      <div class="container">
        <div class="nav">
          <h1><%= link_to "TODOアプリ", root_path, style: "color: white; text-decoration: none;" %></h1>
          <div>
            <% if logged_in? %>
              こんにちは、<%= current_user.name %>さん！
              <%= link_to "プロフィール", user_path(current_user), class: "btn" %>
              <%= link_to "ログアウト", logout_path, method: :delete, class: "btn btn-danger", data: { confirm: "ログアウトしますか？" } %>
            <% else %>
              <%= link_to "ログイン", login_path, class: "btn" %>
              <%= link_to "新規登録", signup_path, class: "btn" %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="container">
      <% flash.each do |type, msg| %>
        <div class="flash <%= type %>"><%= msg %></div>
      <% end %>
      
      <%= yield %>
    </div>
  </body>
</html>